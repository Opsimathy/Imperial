plot_dur_hist(5, 1, FALSE)
h
## 2h will be length of each grid
h <- 1 / (2 * div)
## plot histogram of n'th entry of duration_by_distance, with each bin of width h.
# prob should be a boolean indicating plot density or not.
plot_dur_hist <- function(n, width, prob) {
h <- 0.1
if (n == 1) {
title = paste("distribution of durations for 0-", paste(toString(h), "km journeys",sep=""), sep="")
} else{
title = paste("distribution of durations for", toString(dist_values[n] - h), sep = " ")
title = paste(title, paste(toString(dist_values[n] + h), "km journeys", sep=""), sep="-")
}
if (!prob) { hist(duration_by_distance[[n]], main=title, xlab="duration/min", ylab="frequency", breaks=seq(0, max(duration_by_distance[[n]]) + width, by=width)) }
else { hist(duration_by_distance[[n]], main=title, xlab="duration/min", ylab="density", prob=TRUE) }
}
plot_dur_hist(1, 5, FALSE)
plot_dur_hist(6, 2, FALSE)
plot_dur_hist(8, 2, FALSE)
plot_dur_hist(30, 2, FALSE)
plot_dur_hist(6, 2, FALSE)
plot_dur_hist(5, 1, FALSE)
plot_dur_hist(4, 1, FALSE)
plot_dur_hist(4, 2, FALSE)
ratio_preserved_vec
for (i in 5:length(duration_by_distance)) {
duration_by_distance[[i]] <- duration_by_distance_trimmed[[i-4]]
}
plot_dur_hist(4, 2, FALSE)
for (i in comm_index:length(duration_by_distance)) {
## upper bound for duration
duration_bd <- dist_values[i] * 30
duration_by_distance_trimmed[[i-comm_index+1]] <- duration_by_distance[[i]][duration_by_distance[[i]] < duration_bd]
ratio_preserved_vec <- c(ratio_preserved_vec, length(duration_by_distance_trimmed[[i-comm_index+1]]) / length(duration_by_distance[[i]]))
}
ratio_preserved_vec
for (i in 5:length(duration_by_distance)) {
duration_by_distance[[i]] <- duration_by_distance_trimmed[[i-4]]
}
plot_dur_hist(4, 2, FALSE)
?hist
## plot histogram of n'th entry of duration_by_distance, with each bin of width h.
# prob should be a boolean indicating plot density or not.
plot_dur_hist <- function(n, width, prob, xlim = NULL) {
h <- 0.1
if (n == 1) {
title = paste("distribution of durations for 0-", paste(toString(h), "km journeys",sep=""), sep="")
} else{
title = paste("distribution of durations for", toString(dist_values[n] - h), sep = " ")
title = paste(title, paste(toString(dist_values[n] + h), "km journeys", sep=""), sep="-")
}
if (!prob) { hist(duration_by_distance[[n]], main=title, xlab="duration/min", ylab="frequency", xlim = xlim, breaks=seq(0, max(duration_by_distance[[n]]) + width, by=width)) }
else { hist(duration_by_distance[[n]], main=title, xlab="duration/min", ylab="density", xlim = xlim, prob=TRUE) }
}
plot_dur_hist(4, 2, FALSE, xlim = c(0, 50))
plot_dur_hist(4, 1, FALSE, xlim = c(0, 50))
plot_dur_hist(4, 1, FALSE, xlim = c(0, 40))
fit_icomp_dur_dist(50)
library(fitdistrplus)
fit_icomp_dur_dist(50)
## plot histogram of n'th entry of duration_by_distance, with each bin of width h.
# prob should be a boolean indicating plot density or not.
plot_dur_hist <- function(n, width, prob, xlim = "default") {
if (xlim == "default") {
xlim <- c(min(duration_by_distance[[n]]), max(duration_by_distance[[n]]))
}
h <- 0.1
if (n == 1) {
title = paste("distribution of durations for 0-", paste(toString(h), "km journeys",sep=""), sep="")
} else{
title = paste("distribution of durations for", toString(dist_values[n] - h), sep = " ")
title = paste(title, paste(toString(dist_values[n] + h), "km journeys", sep=""), sep="-")
}
if (!prob) { hist(duration_by_distance[[n]], main=title, xlab="duration/min", ylab="frequency", xlim = xlim, breaks=seq(0, max(duration_by_distance[[n]]) + width, by=width)) }
else { hist(duration_by_distance[[n]], main=title, xlab="duration/min", ylab="density", xlim = xlim, prob=TRUE) }
}
fit_icomp_dur_dist(50)
fit_icomp_dur_dist(10)
## fit inverse gamma, weibull for entry n of duration by distance and compare
fit_icomp_dur_dist <- function(n) {
fitG <- fitdist(1/duration_by_distance[[n]], distr="gamma")
fitW <- fitdist(1/duration_by_distance[[n]], distr="weibull")
par(mfrow=c(1, 1))
plot_dur_hist(n, 2, FALSE)
cdfcomp(list(fitW, fitG), legendtext=c("inverse Weibull","inverse gamma"))
denscomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"))
qqcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
ppcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
}
fit_icomp_dur_dist(10, sep=1)
## fit inverse gamma, weibull for entry n of duration by distance and compare
fit_icomp_dur_dist <- function(n, sep = 2) {
fitG <- fitdist(1/duration_by_distance[[n]], distr="gamma")
fitW <- fitdist(1/duration_by_distance[[n]], distr="weibull")
par(mfrow=c(1, 1))
plot_dur_hist(n, sep, FALSE)
cdfcomp(list(fitW, fitG), legendtext=c("inverse Weibull","inverse gamma"))
denscomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"))
qqcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
ppcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
}
fit_icomp_dur_dist(10, sep=1)
View(plot_dur_hist)
hist(1/ duration_by_distance[[10]], xlab="1 / duration", ylab="frequency", breaks = 50)
## fit inverse gamma, weibull for entry n of duration by distance and compare
fit_icomp_dur_dist <- function(n, sep = 2) {
inv_dur <- 1 / duration_by_distance[[n]]
fitG <- fitdist(inv_dur, distr="gamma")
fitW <- fitdist(inv_dur, distr="weibull")
par(mfrow=c(1, 1))
plot_dur_hist(n, sep, FALSE)
cdfcomp(list(fitW, fitG), legendtext=c("inverse Weibull","inverse gamma"))
denscomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"))
qqcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
ppcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
}
## fit inverse gamma, weibull for entry n of duration by distance and compare
fit_icomp_dur_dist <- function(n, sep = 2) {
inv_dur <- 1 / duration_by_distance[[n]]
fitG <- fitdist(inv_dur, distr="gamma")
fitW <- fitdist(inv_dur, distr="weibull")
par(mfrow=c(1, 1))
plot_dur_hist(n, sep, FALSE)
cdfcomp(list(fitW, fitG), legendtext=c("inverse Weibull","inverse gamma"))
denscomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"))
qqcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
ppcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
}
fit_icomp_dur_dist(10, sep=1)
inv_dur_10 <- duration_by_distance[[10]]
inv_dur_10 <- 1 / duration_by_distance[[10]]
hist(inv_dur_10, xlab="1 / duration", ylab="frequency", breaks = 50)
hist(1/ duration_by_distance[[5]], xlab="1 / duration", ylab="frequency", breaks = 50)
hist(1/ duration_by_distance[[20]], xlab="1 / duration", ylab="frequency", breaks = 50)
hist(1/ duration_by_distance[[15]], xlab="1 / duration", ylab="frequency", breaks = 50)
hist(1/ duration_by_distance[[12]], xlab="1 / duration", ylab="frequency", breaks = 50)
hist(1/ duration_by_distance[[36]], xlab="1 / duration", ylab="frequency", breaks = 50)
hist(duration_by_distance[[36]], xlab="1 / duration", ylab="frequency", breaks = 50)
hist(1/ duration_by_distance[[36]], xlab="1 / duration", ylab="frequency", breaks = 10)
hist(1/ duration_by_distance[[36]], xlab="1 / duration", ylab="frequency", breaks = 100)
rm(inv_dur_10)
hist(1/ duration_by_distance[[5]], xlab="1 / duration", ylab="frequency", breaks = 100)
hist(1/ duration_by_distance[[6]], xlab="1 / duration", ylab="frequency", breaks = 100)
hist(1/ duration_by_distance[[7]], xlab="1 / duration", ylab="frequency", breaks = 100)
hist(1/ duration_by_distance[[10]], xlab="1 / duration", ylab="frequency", breaks = 100)
hist(1/ duration_by_distance[[8]], xlab="1 / duration", ylab="frequency", breaks = 100)
hist(1/ duration_by_distance[[9]], xlab="1 / duration", ylab="frequency", breaks = 100)
hist(1/ duration_by_distance[[15]], xlab="1 / duration", ylab="frequency", breaks = 100)
fit_icomp_dur_dist(15, sep=1)
fit_gamma_191_248$estimate
fit_gamma_191_248$sd
fit_gamma_191_248$method
fit_gamma_191_248$loglik
## fit inverse gamma, weibull for entry n of duration by distance and compare
fit_icomp_dur_dist <- function(n, sep = 2, plot=TRUE) {
inv_dur <- 1 / duration_by_distance[[n]]
fitG <- fitdist(inv_dur, distr="gamma")
fitW <- fitdist(inv_dur, distr="weibull")
if (plot) {
par(mfrow=c(1, 1))
plot_dur_hist(n, sep, FALSE)
cdfcomp(list(fitW, fitG), legendtext=c("inverse Weibull","inverse gamma"))
denscomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"))
qqcomp(list(fitW, fitG), legendtext=c("inverse Weibull", "inverse gamma"), pch=20)
}
list("gamma_fit" = fitG, "Weibull_fit" = fitW)
}
fit_icomp_dur_dist(15, sep=1, plot=FALSE)
result_15 <- fit_icomp_dur_dist(15, sep=1, plot=FALSE)
result_15$gamma_fit$loglik
result_15$Weibull_fit$loglik
length(duration_by_distance)
num
result_15$gamma_fit$sd[1]
result_15$gamma_fit$sd[[1]]
for (i in 1:length(duration_by_distance)){
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fitness$sd[[1]] + GW_fitness$gamma_fitness$sd[[2]]
W_sd <- GW_fitness$Weibull_fitness$sd[[1]] + GW_fitness$Weibull_fitness$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
choice_GW_sd <- c()
choice_GW_loglik <- c()
for (i in 1:length(duration_by_distance)){
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fitness$sd[[1]] + GW_fitness$gamma_fitness$sd[[2]]
W_sd <- GW_fitness$Weibull_fitness$sd[[1]] + GW_fitness$Weibull_fitness$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
for (i in 1:length(duration_by_distance)){
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fitness$sd[[1]] + GW_fitness$gamma_fitness$sd[[2]]
W_sd <- GW_fitness$Weibull_fitness$sd[[1]] + GW_fitness$Weibull_fitness$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
length(choice_GW_loglik)
length(which(choice_GW_loglik))
length(which(choice_GW_sd))
choice_GW_sd
for (i in 1:length(duration_by_distance)){
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fitness$sd[[1]] + GW_fitness$gamma_fitness$sd[[2]]
W_sd <- GW_fitness$Weibull_fitness$sd[[1]] + GW_fitness$Weibull_fitness$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
print(Weibull_better_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
choice_GW_loglik <- c()
choice_GW_sd <- c()
for (i in 1:length(duration_by_distance)){
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fitness$sd[[1]] + GW_fitness$gamma_fitness$sd[[2]]
W_sd <- GW_fitness$Weibull_fitness$sd[[1]] + GW_fitness$Weibull_fitness$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
print(Weibull_better_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
choice_GW_loglik <- c()
choice_GW_sd <- c()
for (i in 1:length(duration_by_distance)){
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fit$sd[[1]] + GW_fitness$gamma_fit$sd[[2]]
W_sd <- GW_fitness$Weibull_fit$sd[[1]] + GW_fit$Weibull_fit$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
print(Weibull_better_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
choice_GW_loglik <- c()
choice_GW_sd <- c()
for (i in 1:length(duration_by_distance)){
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fit$sd[[1]] + GW_fitness$gamma_fit$sd[[2]]
W_sd <- GW_fitness$Weibull_fit$sd[[1]] + GW_fitness$Weibull_fit$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
print(Weibull_better_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
choice_GW_loglik <- c()
choice_GW_sd <- c()
for (i in 1:length(duration_by_distance)){
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
Weibull_better_loglik <- (GW_fitness$gamma_fit$loglik < GW_fitness$Weibull_fit$loglik)
G_sd <- GW_fitness$gamma_fit$sd[[1]] + GW_fitness$gamma_fit$sd[[2]]
W_sd <- GW_fitness$Weibull_fit$sd[[1]] + GW_fitness$Weibull_fit$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
choice_GW_loglik <- c(choice_GW_loglik, Weibull_better_loglik)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
length(which(choice_GW_loglik))
length(which(choice_GW_sd))
plot(choice_GW_loglik)
## positive loglike difference if in favour of Weibull
choice_GW_loglik <- c()
choice_GW_sd <- c()
for (i in 1:length(duration_by_distance)){
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
loglik_diff <- GW_fitness$Weibull_fit$loglik - GW_fitness$gamma_fit$loglik
G_sd <- GW_fitness$gamma_fit$sd[[1]] + GW_fitness$gamma_fit$sd[[2]]
W_sd <- GW_fitness$Weibull_fit$sd[[1]] + GW_fitness$Weibull_fit$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
choice_GW_loglik <- c(choice_GW_loglik, loglik_diff)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
}
length(which(choice_GW_loglik))
plot(dist_values, schoice_GW_loglik, main="loglikelihood difference", xlab="distance/km")
plot(dist_values, choice_GW_loglik, main="loglikelihood difference", xlab="distance/km")
## positive loglike difference if in favour of Weibull
n <- length(duration_by_distance)
n
parameters_Weib <- vector(mode="list", length=n)
choice_GW_loglik <- c()
choice_GW_sd <- c()
parameters_Weib <- vector(mode="list", length=n)
for (i in 1:n) {
print(paste("testing on i = ", toString(i)))
GW_fitness <- fit_icomp_dur_dist(i, plot = FALSE)
loglik_diff <- GW_fitness$Weibull_fit$loglik - GW_fitness$gamma_fit$loglik
G_sd <- GW_fitness$gamma_fit$sd[[1]] + GW_fitness$gamma_fit$sd[[2]]
W_sd <- GW_fitness$Weibull_fit$sd[[1]] + GW_fitness$Weibull_fit$sd[[2]]
Weibull_better_sd <- (W_sd < G_sd)
choice_GW_loglik <- c(choice_GW_loglik, loglik_diff)
choice_GW_sd <- c(choice_GW_sd, Weibull_better_sd)
parameters_Weib[[i]] <- GW_fitness$Weibull_fit$estimate
}
parameters_Weib[[1]][1]
parameters_Weib[[1]][2]
dur_dist_Weib_shape <- c()
dur_dist_Weib_scale <- c()
for (i in 1:n) {
dur_dist_Weib_shape <- c(dur_dist_Weib_shape, parameters_Weib[[i]][1])
dur_dist_Weib_scale <- c(dur_dist_Weib_scale, parameters_Weib[[i]][2])
}
plot(dist_values, dur_dist_Weib_shape, main="shape parameter of Weibull component", xlab="distance/km")
plot(dist_values, dur_dist_Weib_shape, main="shape parameter of Weibull component", xlab="distance/km", pch = 20)
plot(dist_values, dur_dist_Weib_scale, main="scale parameter of Weibull component", xlab="distance/km", pch = 20)
?gamma
hat_Weib_mean <- dur_dist_Weib_scale * gamma(1 + 1 / dur_dist_Weib_shape)
hat_Weib_var <- dur_dist_Weib_scale ^ 2 * (gamma(1 + 2 / dur_dist_Weib_shape) - (gamma(1 + 1 / dur_dist_Weib_shape))^2)
plot(dist_values, hat_Weib_mean, main="mean of Weibull component", xlab="distance/km", pch = 20)
plot(dist_values, hat_Weib_mean, main="mean of 1 / d", xlab="distance/km", pch = 20)
plot(dist_values, hat_Weib_var, main="variance of 1 / duration", xlab="distance/km", pch = 20)
plot(dist_values, hat_Weib_mean, main="mean of 1 / duration", xlab="distance/km", pch = 20)
plot(dist_values, hat_Weib_var, main="variance of 1 / duration", xlab="distance/km", pch = 20)
abline(0, 0, col="red")
dist_values[5]
dist_values[3]
duration_summary_by_station <- trimmed_df %>% group_by(start_id, end_id) %>% summarise(
mean_duration = mean(duration),
sd_duration = sd(duration),
number = n(),
dist = mean(dist)
)
library(dpyrl)
library(dplry)
library(dplyr)
duration_summary_by_station <- trimmed_df %>% group_by(start_id, end_id) %>% summarise(
mean_duration = mean(duration),
sd_duration = sd(duration),
number = n(),
dist = mean(dist)
)
View(duration_by_distance_copy)
duration_summary_by_station
plot_dur_hist_by_station <- function(start_id, end_id, breaks=100) {
dur_data <- df_one_side_trimmed[(df_one_side_trimmed$start_id == start_id) & (df_one_side_trimmed$end_id == end_id), ]$duration
k = ceiling(max(dur_data) / 30)
x_upper <-k  * 30
hist(dur_data, breaks = breaks, xlab = "duration/min", main= paste("Start station: ", toString(start_id), ", end station: ", toString(end_id), sep=""), xlim = c(0, x_upper), xaxp = c(0, x_upper, k))
}
plot_inverse_dur_hist_by_station <- function(start_id, end_id, breaks=100) {
dur_data <- df_one_side_trimmed[(df_one_side_trimmed$start_id == start_id) & (df_one_side_trimmed$end_id == end_id), ]$duration
hist(1/dur_data, breaks = breaks, xlab = "1/duration", main= paste("Start station: ", toString(start_id), ", end station: ", toString(end_id), sep=""))
}
plot_dur_hist_by_station(785, 785)
plot_dur_hist_by_station(191, 191)
plot_dur_hist_by_station(111, 111)
plot_inverse_dur_hist_by_station(111, 111)
durations_768_833 <- trimmed_df[(trimmed_df$start_id == 768) & (trimmed_df$end_id == 833), ]$duration
hist_dur_768_833 <- hist(durations_768_833, main = "histogram from station 768 to station 833", xlab="duration/min", breaks=100)
View(duration_summary_by_station)
nrow(duration_summary_by_station[duration_summary_by_station$number<100, ]) / nrow(duration_summary_by_station)
popularity_order_duration_summary_by_station <- duration_summary_by_station[order(duration_summary_by_station$number), ]
pop100_duration_summary <- popularity_order_duration_summary_by_station[, 1:100]
pop100_duration_summary <- head(popularity_order_duration_summary_by_station, 100)
popularity_order_duration_summary_by_station <- duration_summary_by_station[order(duration_summary_by_station$number, decreasing = TRUE), ]
pop100_duration_summary <- head(popularity_order_duration_summary_by_station, 100)
leis_ratio_station <- length(pop100_duration_summary[(pop100_duration_summary$start_id == pop100_duration_summary$end_id),]) / length(pop100_duration_summary)
leis_ratio_station
leis_ratio_station <- length(pop100_duration_summary[(pop100_duration_summary$start_id == pop100_duration_summary$end_id),]$start_id) / length(pop100_duration_summary$start_id)
leis_ratio_station
## return the ratio of journeys with start_id = end_id for the n most popular edges
leis_ratio_by_station <- function(n) {
pop_duration_summary <- head(popularity_order_duration_summary_by_station, n)
length(pop_duration_summary[(pop_duration_summary$start_id == pop_duration_summary$end_id),]$start_id) / length(pop_duration_summary$start_id)
}
leis_ratio_by_station(100)
leis_ratio_by_station(500)
popularity <- seq(from = 50, to = 3000, by = 50)
plot(popularity, leis_ratio_by_station(popularity), ylab="ratio of self-connecting edges(start_id = end_id)", pch=20)
leis_ratio_by_station(popularity)
plot(popularity, sapply(popularity, leis_ratio_by_station), ylab="ratio of self-connecting edges(start_id = end_id)", pch=20)
plot(popularity, sapply(popularity, leis_ratio_by_station), ylab="ratio", main = "ratio of self-connecting edges(start_id = end_id) among the most popular edges", pch=20)
plot(popularity, sapply(popularity, leis_ratio_by_station), ylab="ratio", main = "ratio of self-connecting edges(start_id = end_id)  \n among the most popular edges", pch=20)
library(prestige)
prestige.R
prestige.R prestige-data.RData
load("~/Downloads/Block1.RData")
library('Matrix')
library('Matrix')
load("~/Downloads/Block1.RData")
load("~/Downloads/Block1.RData")
fig()
figs()
View(swiss.lasso.pred2)
View(swiss.ridge.pred)
library(glmnet)
library('glmnet')
install.packages('glmnet')
library('glmnet')
View(cv.lasso)
swiss_lasso <- glmnet(x[train,], y[train], alpha=1, lambda = 10)
swiss_lasso_pred <- x %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso <- glmnet(x[train,], y[train], alpha=1, lambda = c(0.01, 0.1, 1, 10, 100))
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso <- glmnet(x[train,], y[train], alpha=1, lambda = 0.1)
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso <- glmnet(x[train,], y[train], alpha=1, lambda = 0.01)
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso <- glmnet(x[train,], y[train], alpha=1, lambda = 1)
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso <- glmnet(x[train,], y[train], alpha=1, lambda = 4)
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso <- glmnet(x[train,], y[train], alpha=0, lambda = 4)
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
swiss_lasso <- glmnet(x[train,], y[train], alpha=0, lambda = 0.1)
swiss_lasso_pred <- x[test,] %*% swiss_lasso$beta
mse(ytest, swiss_lasso_pred)
setwd(..)
setwd("..")
load("Block2.RData
")
load("Block2.RData")
load("./Block2.RData")
load("R_Data/Block2.RData")
getwd()
setwd("../linyuhang/Downloads/Imperial/Statistical Learning")
setwd("../linyuhang/Downloads/Imperial/Statistical Learning")
setwd("Users/linyuhang/Downloads/Imperial/Statistical Learning")
setwd("/Users/linyuhang/Downloads/Imperial/Statistical Learning")
load("R_Data/Block2.RData")
summary(eurodist)
print(eurodist)
eurodist_obj <- as.dist(eurodist)
print(size(eurodist))
print(eurodist.size)
print(eurodist_obj.size)
eurodist_soln <- cmdscale(eurodist_obj, k=10, eig=TRUE)
# plot the Eigenvalues
plot(1:21, eurodist_soln$eig, xlab="Eigenvalue index", ylab="Eigenvalues")
abline(h=0, lty=2)
abline(h=0, lty=2, col="red")
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=dimnames(eurodist))
plot.new()
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=dimnames(eurodist))
plot(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=dimnames(eurodist))
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=dimnames(eurodist))
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=dimnames(eurodist), cex=0.7, col=2)
dimnames(eurodist)
eurodist
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=colnames(eurodist), cex=0.7, col=2)
colnames(eurodist)
rownames(eurodist)
labels(eurodist)
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=labels(eurodist), cex=0.7, col=2)
plot.new()
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=labels(eurodist), cex=0.7, col=2)
plot(eurodist_soln$points[,2], eurodist_soln$points[,1], cex=0.7, col="white")
text(eurodist_soln$points[,2], eurodist_soln$points[,1], labels=labels(eurodist), cex=0.7, col=2)
plot.new()
plot(eurodist_soln$points[,2], -eurodist_soln$points[,1], cex=0.7, col="white")
text(eurodist_soln$points[,2], -eurodist_soln$points[,1], labels=labels(eurodist), cex=0.7, col=2)
plot(-eurodist_soln$points[,1], -eurodist_soln$points[,2], cex=0.7, col="white")
text(eurodist_soln$points[,1], -eurodist_soln$points[,2], labels=labels(eurodist), cex=0.7, col=2)
plot(eurodist_soln$points[,3], 1:21, xlab="value of third dimension", ylab="false height", labels=labels(eurodist))
plot(eurodist_soln$points[,3], 1:21, col="white")
text(eurodist_soln$points[,3], 1:21, xlab="value of third dimension", ylab="false height", labels=labels(eurodist))
text(sort(eurodist_soln$points[,3]), 1:21, xlab="value of third dimension", ylab="false height", labels=labels(eurodist))
plot(eurodist_soln$points[,3], 1:21, col="white")
text(sort(eurodist_soln$points[,3]), 1:21, xlab="value of third dimension", ylab="false height", labels=labels(eurodist))
plot(eurodist_soln$points[,3], 1:21, col="white", xlab="value of third dimension", ylab="false height")
text(sort(eurodist_soln$points[,3]), 1:21, labels=labels(eurodist))
?UScitiesD
### US Cities distance ###
UScitiesD_obj <- as.dist(UScitiesD)
UScitiesD_soln <- cmdscale(UScitiesD_obj, k=10, eig=TRUE)
print(size(ScitiesD_obj))
print(ScitiesD_obj.size)
print(ScitiesD_obj])
print(ScitiesD_obj)
print(UScitiesD_obj)
print(UScitiesD_obj.size)
print(UScitiesD_obj.length)
print(UScitiesD_obj.len)
print(UScitiesD_obj.shape)
UScitiesD_soln <- cmdscale(UScitiesD_obj, k=5, eig=TRUE)
# plot the Eigenvalues
plot(1:5, eurodist_soln$eig, xlab="Eigenvalue index", ylab="Eigenvalues")
# plot the Eigenvalues
plot(1:5, UScitiesD_soln$eig, xlab="Eigenvalue index", ylab="Eigenvalues")
# plot the Eigenvalues
plot(1:10, UScitiesD_soln$eig, xlab="Eigenvalue index", ylab="Eigenvalues")
abline(h=0, lty=2, col="red")
plot(UScitiesD_soln$points[,1], UScitiesD_soln$points[,2], cex=0.7, col="white")
text(UScitiesD_soln$points[,1], UScitiesD_soln$points[,2], labels=labels(eurodist), cex=0.7, col=2)
plot(UScitiesD_soln$points[,1], UScitiesD_soln$points[,2], cex=0.7, col="white")
text(UScitiesD_soln$points[,1], UScitiesD_soln$points[,2], labels=labels(UScitiesD), cex=0.7, col=2)
plot(-UScitiesD_soln$points[,1], -UScitiesD_soln$points[,2], cex=0.7, col="white")
text(-UScitiesD_soln$points[,1], -UScitiesD_soln$points[,2], labels=labels(UScitiesD), cex=0.7, col=2)
